image: golang:1.17.2

build:
  stage: build
  tags:
    - docker
  #  rules:
  #    - if: '$CI_COMMIT_TAG == null'
  #      when: manual
  script:
    - go run build/ci.go install ./cmd/geth ./cmd/bootnode
    - mkdir -p ./dist
    - cp ./build/bin/bootnode ./dist/gwat-bootnode
    - cp ./build/bin/geth ./dist/gwat
  artifacts:
    paths:
      - dist/gwat-bootnode
      - dist/gwat
